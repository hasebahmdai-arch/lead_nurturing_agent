# Generated by Django 5.2.8 on 2025-11-12 14:24

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('crm', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Campaign',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=128)),
                ('project_name', models.CharField(choices=[('Altura', 'Altura'), ('Beachgate by Address', 'Beachgate by Address'), ('Damac Bay by Cavalli', 'Damac Bay by Cavalli'), ('DLF West Park', 'DLF West Park'), ('Godrej Vistas', 'Godrej Vistas'), ('Lumina Grand', 'Lumina Grand'), ('Sobha Crest', 'Sobha Crest'), ('Sobha Waves', 'Sobha Waves')], max_length=64)),
                ('message_channel', models.CharField(choices=[('email', 'Email'), ('whatsapp', 'WhatsApp')], default='email', max_length=32)),
                ('offer_details', models.TextField(blank=True)),
                ('filters', models.JSONField(blank=True, default=dict)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='campaigns', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ('-created_at',),
            },
        ),
        migrations.CreateModel(
            name='CampaignLead',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('shortlisted_at', models.DateTimeField(auto_now_add=True)),
                ('personalized_message', models.TextField(blank=True)),
                ('dispatch_time', models.DateTimeField(blank=True, null=True)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('sent', 'Sent'), ('responded', 'Responded'), ('goal_met', 'Goal Met')], default='pending', max_length=32)),
                ('goal_outcome', models.CharField(choices=[('none', 'None'), ('call', 'Sales Call Scheduled'), ('visit', 'Property Visit Scheduled')], default='none', max_length=32)),
                ('scheduled_datetime', models.DateTimeField(blank=True, null=True)),
                ('last_customer_message_at', models.DateTimeField(blank=True, null=True)),
                ('last_agent_message_at', models.DateTimeField(blank=True, null=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('campaign', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='lead_links', to='campaigns.campaign')),
                ('lead', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='campaign_links', to='crm.lead')),
            ],
            options={
                'ordering': ('-shortlisted_at',),
                'unique_together': {('campaign', 'lead')},
            },
        ),
        migrations.CreateModel(
            name='ConversationMessage',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('sender', models.CharField(choices=[('agent', 'AI Agent'), ('customer', 'Customer'), ('sales', 'Sales Associate')], max_length=16)),
                ('message', models.TextField()),
                ('intent', models.CharField(blank=True, max_length=64)),
                ('metadata', models.JSONField(blank=True, default=dict)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('campaign_lead', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='messages', to='campaigns.campaignlead')),
            ],
            options={
                'ordering': ('created_at',),
            },
        ),
    ]
